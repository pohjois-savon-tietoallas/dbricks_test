<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Setting up RStudio | _main.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Setting up RStudio | _main.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Setting up RStudio | _main.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="configure-connection-settings.html"/>
<link rel="next" href="troubleshoot.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="cluster-setup.html"><a href="cluster-setup.html"><i class="fa fa-check"></i><b>2</b> Cluster setup</a></li>
<li class="chapter" data-level="3" data-path="client-setup.html"><a href="client-setup.html"><i class="fa fa-check"></i><b>3</b> Client setup</a><ul>
<li class="chapter" data-level="3.1" data-path="client-setup.html"><a href="client-setup.html#install-java"><i class="fa fa-check"></i><b>3.1</b> Install Java</a></li>
<li class="chapter" data-level="3.2" data-path="client-setup.html"><a href="client-setup.html#install-python"><i class="fa fa-check"></i><b>3.2</b> Install Python</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="get-connection-values.html"><a href="get-connection-values.html"><i class="fa fa-check"></i><b>4</b> Get connection values</a></li>
<li class="chapter" data-level="5" data-path="configure-connection-settings.html"><a href="configure-connection-settings.html"><i class="fa fa-check"></i><b>5</b> Configure connection settings</a></li>
<li class="chapter" data-level="6" data-path="setting-up-rstudio.html"><a href="setting-up-rstudio.html"><i class="fa fa-check"></i><b>6</b> Setting up RStudio</a></li>
<li class="chapter" data-level="7" data-path="troubleshoot.html"><a href="troubleshoot.html"><i class="fa fa-check"></i><b>7</b> Troubleshoot</a><ul>
<li class="chapter" data-level="7.1" data-path="troubleshoot.html"><a href="troubleshoot.html#mac-error-starting-a-spark-session"><i class="fa fa-check"></i><b>7.1</b> Mac: Error starting a spark session</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="text-mining-with-sparklyr.html"><a href="text-mining-with-sparklyr.html"><i class="fa fa-check"></i><b>8</b> Text mining with <code>sparklyr</code></a><ul>
<li class="chapter" data-level="8.1" data-path="text-mining-with-sparklyr.html"><a href="text-mining-with-sparklyr.html#data-importg"><i class="fa fa-check"></i><b>8.1</b> Data Importg</a></li>
<li class="chapter" data-level="8.2" data-path="text-mining-with-sparklyr.html"><a href="text-mining-with-sparklyr.html#tidying-data"><i class="fa fa-check"></i><b>8.2</b> Tidying data</a></li>
<li class="chapter" data-level="8.3" data-path="text-mining-with-sparklyr.html"><a href="text-mining-with-sparklyr.html#transform-the-data"><i class="fa fa-check"></i><b>8.3</b> Transform the data</a></li>
<li class="chapter" data-level="8.4" data-path="text-mining-with-sparklyr.html"><a href="text-mining-with-sparklyr.html#data-exploration"><i class="fa fa-check"></i><b>8.4</b> Data Exploration</a></li>
<li class="chapter" data-level="8.5" data-path="text-mining-with-sparklyr.html"><a href="text-mining-with-sparklyr.html#appendix"><i class="fa fa-check"></i><b>8.5</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="intro-to-sparklyr.html"><a href="intro-to-sparklyr.html"><i class="fa fa-check"></i><b>9</b> Intro to <code>sparklyr</code></a><ul>
<li class="chapter" data-level="9.1" data-path="intro-to-sparklyr.html"><a href="intro-to-sparklyr.html#new-spark-session"><i class="fa fa-check"></i><b>9.1</b> New Spark session</a></li>
<li class="chapter" data-level="9.2" data-path="intro-to-sparklyr.html"><a href="intro-to-sparklyr.html#data-transfer"><i class="fa fa-check"></i><b>9.2</b> Data transfer</a></li>
<li class="chapter" data-level="9.3" data-path="intro-to-sparklyr.html"><a href="intro-to-sparklyr.html#spark-and-dplyr"><i class="fa fa-check"></i><b>9.3</b> Spark and <code>dplyr</code></a></li>
<li class="chapter" data-level="9.4" data-path="intro-to-sparklyr.html"><a href="intro-to-sparklyr.html#feature-transformers"><i class="fa fa-check"></i><b>9.4</b> Feature transformers</a></li>
<li class="chapter" data-level="9.5" data-path="intro-to-sparklyr.html"><a href="intro-to-sparklyr.html#models"><i class="fa fa-check"></i><b>9.5</b> Models</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="testing-databricks-connect-on-desktop-rstudio-.html"><a href="testing-databricks-connect-on-desktop-rstudio-.html"><i class="fa fa-check"></i><b>10</b> Testing databricks connect on desktop RStudio.</a><ul>
<li class="chapter" data-level="10.1" data-path="testing-databricks-connect-on-desktop-rstudio-.html"><a href="testing-databricks-connect-on-desktop-rstudio-.html#connect-to-databricks"><i class="fa fa-check"></i><b>10.1</b> Connect to databricks</a></li>
<li class="chapter" data-level="10.2" data-path="testing-databricks-connect-on-desktop-rstudio-.html"><a href="testing-databricks-connect-on-desktop-rstudio-.html#test"><i class="fa fa-check"></i><b>10.2</b> Test</a></li>
<li class="chapter" data-level="10.3" data-path="testing-databricks-connect-on-desktop-rstudio-.html"><a href="testing-databricks-connect-on-desktop-rstudio-.html#datasets"><i class="fa fa-check"></i><b>10.3</b> Datasets</a></li>
<li class="chapter" data-level="10.4" data-path="testing-databricks-connect-on-desktop-rstudio-.html"><a href="testing-databricks-connect-on-desktop-rstudio-.html#stop"><i class="fa fa-check"></i><b>10.4</b> Stop</a></li>
<li class="chapter" data-level="10.5" data-path="testing-databricks-connect-on-desktop-rstudio-.html"><a href="testing-databricks-connect-on-desktop-rstudio-.html#notes"><i class="fa fa-check"></i><b>10.5</b> Notes</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="setting-up-rstudio" class="section level1">
<h1><span class="header-section-number">6</span> Setting up RStudio</h1>
<p>Start off by downloading and unpacking <a href="https://spark.apache.org/downloads.html">Spark</a> on your computer. Make sure the Hadoop version of Spark is 2.7. Unpack in e.g. <code>C:\\Users\\username\\AppData\\Local\\Apache\\Spark</code>. Make a note of where you unpacked spark.</p>
<p><strong>Windows users</strong><br />
Spark will not work on Windows without WinUtils, which contains Windows binaries for Hadoop. This will require admin privileges. More information can be found <a href="https://datathirst.net/blog/2019/4/20/setup-databricks-connect-on-windows">here.</a> Also, make sure that your installation path (includes your username) for Spark does not have a space in it! If it does you can get around it by modifying the Windows registry, which can really screw up your Windows installation! Do this at your own risk! More information can be found <a href="https://datathirst.net/blog/2019/4/20/setup-databricks-connect-on-windows">here.</a></p>
<p>Then run the following command to get the path where the pyspark Java archive files are:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ex">databricks-connect</span> get-jar-dir</a></code></pre></div>
<p>This will return a path like this</p>
<ul>
<li><p>Windows: <code>C:\\users\\username\\appdata\\local\\continuum\\anaconda3\\envs\\dbconnect\\lib\\site-packages\\pyspark/jars</code></p></li>
<li><p>Mac: <code>/usr/local/lib/python3.7/site-packages/pyspark/jars</code></p></li>
</ul>
<p>Copy the file path of one directory above the JAR directory file path. For example <code>C:\\users\\username\\appdata\\local\\continuum\\anaconda3\\envs\\dbconnect\\lib\\site-packages\\pyspark</code></p>
<p>Now switch over to RStudio. First, install <code>SparkR</code> with command <code>install.packages(&quot;SparkR&quot;)</code>. Then copy the two file directory paths and use them to tell SparkR where to look for Spark and pyspark. On a Windows computer backslashes need to be escaped, therefore the double backslashes in the path names. On a Mac computer the path will have front slashes.</p>
<p>In Windows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">library</span>(SparkR, <span class="dt">lib.loc =</span> <span class="kw">.libPaths</span>(<span class="kw">c</span>(<span class="kw">file.path</span>(<span class="st">&quot;C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">username</span><span class="ch">\\</span><span class="st">AppData</span><span class="ch">\\</span><span class="st">Local</span><span class="ch">\\</span><span class="st">Apache</span><span class="ch">\\</span><span class="st">Spark</span><span class="ch">\\</span><span class="st">Cache</span><span class="ch">\\</span><span class="st">spark-2.4.3-bin-hadoop2.7&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;lib&quot;</span>), <span class="kw">.libPaths</span>())))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw">Sys.setenv</span>(<span class="dt">SPARK_HOME =</span> <span class="st">&quot;c:</span><span class="ch">\\</span><span class="st">users</span><span class="ch">\\</span><span class="st">ericle</span><span class="ch">\\</span><span class="st">appdata</span><span class="ch">\\</span><span class="st">local</span><span class="ch">\\</span><span class="st">continuum</span><span class="ch">\\</span><span class="st">anaconda3</span><span class="ch">\\</span><span class="st">envs</span><span class="ch">\\</span><span class="st">dbconnect_6_2</span><span class="ch">\\</span><span class="st">lib</span><span class="ch">\\</span><span class="st">site-packages</span><span class="ch">\\</span><span class="st">pyspark&quot;</span>)</a></code></pre></div>
<p>In Mac:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">library</span>(SparkR, <span class="dt">lib.loc =</span> <span class="kw">.libPaths</span>(<span class="kw">c</span>(<span class="kw">file.path</span>(<span class="st">&quot;~/AppData/spark-2.4.5-bin-hadoop2.7/&quot;</span>, <span class="st">&#39;R&#39;</span>, <span class="st">&#39;lib&#39;</span>), <span class="kw">.libPaths</span>())))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">Sys.setenv</span>(<span class="dt">SPARK_HOME =</span> <span class="st">&quot;/usr/local/lib/python3.7/site-packages/pyspark/&quot;</span>)</a></code></pre></div>
<p>You should now be able to initiate a Spark session and start running SparkR commands. If your cluster is not running it should start automatically (this might take some minutes).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">SparkR<span class="op">::</span><span class="kw">sparkR.session</span>()</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">as.DataFrame</span>(faithful)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">df1 &lt;-<span class="st"> </span><span class="kw">dapply</span>(df, <span class="cf">function</span>(x) { x }, <span class="kw">schema</span>(df))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">collect</span>(df1)</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">nba_player_stats &lt;-<span class="st"> </span><span class="kw">read.df</span>(<span class="dt">source =</span> <span class="st">&quot;csv&quot;</span>, <span class="dt">path =</span> <span class="st">&quot;dbfs:/FileStore/tables/nbaplayerstats1519_2-d5cfb.csv&quot;</span>, <span class="dt">header=</span><span class="st">&quot;true&quot;</span>, <span class="dt">inferSchema =</span> <span class="st">&quot;true&quot;</span>, <span class="dt">sep =</span> <span class="st">&#39;;&#39;</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">head</span>(nba_player_stats)</a></code></pre></div>
<p>You can stop the Spark session but the cluster will not shut down until the preset autotermination time, or until you terminate it manually.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">SparkR<span class="op">::</span><span class="kw">sparkR.session.stop</span>()</a></code></pre></div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="configure-connection-settings.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="troubleshoot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
